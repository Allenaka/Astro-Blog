---
import MarkdownLayout from "@/layouts/MarkdownLayout.astro";
import BlogInfo from "@/components/BlogInfo.astro";
import type Frontmatter from "@/declare/Frontmatter";
import PostsInfo from "@/components/Pages/posts/PostsInfo.astro";
import WhiteModule from "@/components/WhiteModule.astro";

const { name } = Astro.params;
if (!name) Astro.redirect("/404");

const ListData = await Astro.glob<Frontmatter>("/source/_Post/*/*.md");
let target = null;

for (const i of ListData) {
  if (i.frontmatter.title == name) {
    target = i;
    break;
  }
}

if (!target) Astro.redirect("/404");

const MD = target?.Content;
---

<MarkdownLayout content={target ? target!.frontmatter : {}}>
  <WhiteModule  slot="before-markdown" >
    <PostsInfo/>
  </WhiteModule>
  {
    target ? (
      // @ts-expect-error
      <MD />
    ) : (
      <></>
    )
  }
  <BlogInfo slot="after-markdown" horizontal={true} />
</MarkdownLayout>

<style lang="scss" is:global>
  .white_module {
    margin-bottom: 1rem;
  }
</style>